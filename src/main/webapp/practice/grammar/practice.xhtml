<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:fmt="http://java.sun.com/jstl/fmt"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
  	xmlns:esl="http://www.funfunspell.com/jsf"
  	template="/template/short.xhtml">
  	
	<ui:define name="subTitle">#{htmlHeadMsg.practice_grammar_practice_title}</ui:define>
	<ui:define name="head">
		<meta name="keywords" content="#{htmlHeadMsg.practice_grammar_desc}" />		 
		<script type="text/javascript">
		//<![CDATA[
			jQuery.noConflict();
			
			jQuery(document).ready(
				function() {
					jQuery('input[id*=answer]').each(function(i) {
						jQuery(this).focus(function () {
							jQuery('#question'+(i+1)).css('background-color','#ecf71b');
							
							// scroll to the position
							var offset = jQuery('#question'+(i+1)).offset().top - jQuery('#scrollablePassage').offset().top;
							if (offset < 0 || offset > 500) {jQuery('#scrollablePassage').animate({scrollTop:  '+=' + offset + 'px'},{ queue: false });}
						});
						
						jQuery(this).blur(function () {
							jQuery('#question'+(i+1)).css('background-color','');
						});
					})
			});

		//]]>
		</script>
		<style type="text/css">
			.grammarPassage {
				color: #555;
				font-family: courier, monospace;

				line-height : 30px;
			}
			.grammarPassage span.grammarQuestion {
				border-bottom: 2px solid #763232;
				color: #763232;
				font-weight : bold;
			}
		</style>
	</ui:define>
	
	<ui:define name="mainDiv">
		<div class="w3-container w3-green">
			<h2>#{grammarMsg.grammarPractice} <i class="fa fa-language" aria-hidden="true"></i></h2>
		</div>

		<div class="w3-margin w3-padding-bottom">
			<div class="w3-panel">
				<h:form id="inputForm">
					<table style="width: 100%;" cellpadding="0" cellspacing="0">
						<tr>
							<td>#{grammarMsg.practiceType}: <strong>#{grammarPracticeController.practiceTypeString}</strong></td>
							<td valign="bottom"></td>
						</tr>
						<tr>
							<td colspan="2" style="padding-bottom: 20px;">
								<div id="possibleAnswers" class="w3-container">
									<button onclick="addOrRemoveW3Show('q1')" class="w3-btn-block w3-left-align w3-medium w3-pale-blue">
										<i class="fa fa-chevron-down" aria-hidden="true"></i> #{grammarMsg.possibleAnswers}
									</button>
									<div id="q1" class="w3-accordion-content w3-container w3-medium w3-pale-blue w3-leftbar w3-border-blue">
										<rich:dataGrid style="width: 100%;" value="#{grammarPracticeController.practice.sortedPossibleQuestions}" var="q" columns="6" border="0">
											<h:outputText style="color: #333; font-family: courier, monospace; font-size: 16px;" value="#{q}" />
										</rich:dataGrid>
									</div>
								</div>
							</td>
						</tr>
						<tr>
							<td style="padding-right: 5px;" valign="top" align="left">
								<table style="background-color: #f5f5f5; table-layout:fixed; background-image: url('#{request.contextPath}/images/graphic/notebook.png'); background-repeat:repeat;">
									<tr>
										<td style="width: 25px;" class="w3-hide-small">&#160;</td>
										<td style="width: 1px; border-left: 1px solid #ffaa9f; border-right: 1px solid #ffaa9f;" class="w3-hide-small"></td>
										<td>
											<div id="scrollablePassage" style="overflow: auto; max-width: 700px;">
												<h:outputText escape="false" styleClass="grammarPassage" value="#{grammarPracticeController.practice.htmlPassageWithQuestions}" />
											</div>
										</td>
									</tr>
								</table>
							</td>
							<td valign="top">
								<table>
									<a4j:repeat var="answer" rowKeyVar="r" value="#{grammarPracticeController.inputAnswers}">
									<tr>
										<td id="inputTD#{r+1}" class="w3-medium">
											<h:inputText type="text" style="min-width: 120px; padding: 0px;" maxlength="15" id="answer#{r+1}" name="answer#{r+1}"
														 a:placeholder="#{r+1}" styleClass="w3-input"
														 value="#{grammarPracticeController.inputAnswers[r]}" autocomplete="off" />
										</td>
									</tr>
									</a4j:repeat>
								</table>
							</td>
						</tr>
					</table>
					<div class="w3-right-align w3-padding-top">
						<h:commandLink styleClass="w3-btn w3-green" onclick="return submitRequest();" action="#{grammarPracticeController.submitAnswer}"><i class="fa fa-check" aria-hidden="true"></i> #{grammarMsg.submitAnswer}</h:commandLink>
					</div>
				</h:form>
			</div>
		</div>
	</ui:define>	
	
</ui:composition>