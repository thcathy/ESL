<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:t="http://myfaces.apache.org/tomahawk"
				xmlns:c="http://java.sun.com/jsp/jstl/core"
				xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
				xmlns:a4j="http://richfaces.org/a4j"
				xmlns:rich="http://richfaces.org/rich"
				xmlns:esl="http://www.funfunspell.com/jsf"
				xmlns:util="http://java.sun.com/jsf/composite/components/util"
				xmlns:practice="http://java.sun.com/jsf/composite/components/practice"
				template="/template/short.xhtml">

	<ui:define name="subTitle">#{htmlHeadMsg.practice_selfdictation_practice_title}</ui:define>	
	<ui:define name="head">
		<meta name="keywords" content="#{htmlHeadMsg.practice_selfdictation_practice_desc}" />
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
		<script type="text/javascript" src="${request.contextPath}/js/jquery-ui-1.7.2.custom.min.js"></script>
		<script src="http://code.responsivevoice.org/responsivevoice.js"></script>
		<script type="text/javascript">
		//<![CDATA[ 
		jQuery.noConflict();
		
		var answerEnterEvent = function(event) {				
			var keycode = (event.keyCode ? event.keyCode : (event.which ? event.which : event.charCode));
	      	if (keycode == 13) { // keycode for enter key
	        	jQuery('#practiceDiv\\:inputForm\\:eslSubmit').click();
	        	return false;
	      	}
		};
				
		jQuery(document).ready(function() {
			jQuery('#practiceDiv\\:inputForm\\:answer').keydown(answerEnterEvent);
			jQuery('#practiceDiv\\:inputForm\\:answer').focus();
		});
		
		function updateAfterSubmit() {
			animateScoreBar(jQuery('#hiddenCurrentMark').val(), jQuery('#hiddenMaxMark').val());			
			resetImage(jQuery('#hiddenPicPaths').val().split(','));			
			jQuery('#practiceDiv\\:inputForm\\:answer').keydown(answerEnterEvent);			
			jQuery('#practiceDiv\\:inputForm\\:answer').focus();
			
		}
		//]]>
		</script>	
	</ui:define>

	<ui:define name="mainDiv">

		<div class="w3-container w3-green">
			<h3>
				<a4j:outputPanel id="topHeader">
					<h:outputFormat value="#{selfDictationMsg.practiceQuestionTitle}">
						<f:param value="#{selfDictationController.practice.currentQuestion+1}"/>
						<f:param value="#{selfDictationController.practice.totalQuestions}"/>
					</h:outputFormat>
				</a4j:outputPanel>
				<span class="w3-right w3-hide-small"><i class="fa fa-pencil-square" aria-hidden="true"></i> #{generalMsg.dictation}</span>
			</h3>
		</div>

		<div class="w3-margin w3-xlarge w3-padding-bottom w3-text-teal">
			<practice:dictationpracticemain2 id="practiceDiv" controllerBean="#{selfDictationController}" />

			<esl:scoreBar2 startMark="#{selfDictationController.practice.mark}" maxMark="#{selfDictationController.practice.totalQuestions}" />

			<a4j:outputPanel id="msgPanel">
				<div class="w3-medium w3-panel w3-pale-green w3-leftbar w3-border-green">
					<h:messages tooltip="false" styleClass="w3-ul" globalOnly="true" />
				</div>
			</a4j:outputPanel>

			<a4j:outputPanel id="historyRegion">
				<a4j:outputPanel rendered="#{selfDictationController.practice.currentQuestion > 0}">
					<div class="w3-responsive">
						<!-- Histories -->
						<table class="w3-table-all w3-medium w3-margin-top">
							<thead>
							<tr class="w3-theme">
								<td></td>
								<td><h:outputText value="#{selfDictationMsg.practicePhonetic}" /></td>
								<td><h:outputText value="#{selfDictationMsg.practiceWord}" /></td>
								<td><h:outputText value="#{selfDictationMsg.practiceAnswer}" /></td>
								<td></td>
							</tr>
							</thead>
							<tfoot>
								<tr><td colspan="5"><h:outputText value="#{selfDictationMsg.practiceMark}" />: ${selfDictationController.practice.mark}  / ${selfDictationController.practice.currentQuestion}</td></tr>
							</tfoot>
							<t:dataList var="i" rowIndexVar="index" value="#{selfDictationController.practice.answers}" >
								<tr>
									<td>Q<h:outputText value="#{selfDictationController.practice.currentQuestion-index}" /></td>
									<td>[<h:outputText escape="false" value="#{selfDictationController.practice.questions[selfDictationController.practice.currentQuestion-1-index].IPA}" />]</td>
									<td><a href="#{phonPracticeMsg.practiceDictionaryLink}#{selfDictationController.practice.questions[selfDictationController.practice.currentQuestion-1-index].word}" target="_blank"><u><h:outputText value="#{selfDictationController.practice.questions[selfDictationController.practice.currentQuestion-1-index].word}" /></u></a></td>
									<td><h:outputText value="#{selfDictationController.practice.answers[selfDictationController.practice.currentQuestion-1-index]}" /></td>
									<td>
										<a4j:outputPanel rendered="#{selfDictationController.practice.corrects[selfDictationController.practice.currentQuestion-1-index]}"><i class="fa fa-check w3-text-light-green" aria-hidden="true"></i></a4j:outputPanel>
										<a4j:outputPanel rendered="#{!selfDictationController.practice.corrects[selfDictationController.practice.currentQuestion-1-index]}"><i class="fa fa-times w3-text-red" aria-hidden="true"></i></a4j:outputPanel>
									</td>
								</tr>
							</t:dataList>
						</table>
					</div>
					<div class="w3-container w3-light-grey w3-border w3-small">
						<p>* #{selfDictationMsg.practiceWordExplanation}</p>
					</div>
				</a4j:outputPanel>
			</a4j:outputPanel>
		</div>
	</ui:define>


</ui:composition>