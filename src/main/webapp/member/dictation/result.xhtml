<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:t="http://myfaces.apache.org/tomahawk"
				xmlns:c="http://java.sun.com/jsp/jstl/core"
				xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
				xmlns:a4j="http://richfaces.org/a4j"
				xmlns:rich="http://richfaces.org/rich"
				xmlns:esl="http://www.funfunspell.com/jsf"
				xmlns:util="http://java.sun.com/jsf/composite/components/util"
				template="/template/short.xhtml">

	<ui:define name="subTitle">#{htmlHeadMsg.practice_selfdictation_result_title}</ui:define>
	<ui:define name="head">
		<meta name="keywords" content="#{htmlHeadMsg.practice_selfdictation_result_desc}" />
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
        <script type="text/javascript" src="${request.contextPath}/js/jquery-ui-1.7.2.custom.min.js"></script>
		<script type="text/javascript">
			//<![CDATA[
			jQuery.noConflict();
			//]]>
		</script>
	</ui:define>

	<ui:define name="mainDiv">
		<div class="w3-container w3-green">
			<h3>
				<i class="fa fa-pencil-square" aria-hidden="true"></i> #{generalMsg.dictation}
			</h3>
		</div>

		<h:form id="inputForm">
			<div class="w3-margin w3-padding-bottom w3-text-teal">
				<esl:dictationNav2 />

				<div class="w3-row w3-center w3-margin w3-medium">
					<h:commandLink styleClass="w3-btn w3-green w3-margin-right" onclick="return showSpinner();"
                                   action="#{dictationPracticeController.authDictation}">
						<i class="fa fa-repeat" aria-hidden="true"></i> #{selfDictationMsg.resultRetry}</h:commandLink>
					<a4j:commandLink id="recommendDictation" render="dictationButtons dictationSummary"
									 oncomplete="highlightDictationSummaryRecommendation();"
									 action="#{dictationPracticeController.recommendDictation}"
									 styleClass="w3-btn w3-theme-l1">
						<i class="fa fa-thumbs-o-up" aria-hidden="true"></i> #{selfDictationMsg.resultRecommend}</a4j:commandLink>

					<span id="spinner" class="w3-hide"><i class="fa fa-spinner w3-spin" style="font-size:28px"></i></span>
				</div>

				<h3>
					<h:outputFormat value="#{selfDictationMsg.resultTitle}">
						<f:param value="#{dictationPracticeController.practice.mark}" />
						<f:param value="#{dictationPracticeController.practice.totalQuestions}" />
					</h:outputFormat>
				</h3>

				<div class="w3-row-padding w3-margin-top w3-margin-bottom">
					<div class="w3-half">
						<a4j:outputPanel id="dictationSummary">
							<esl:oneDictationSummary2 dictation="#{dictationPracticeController.dictation}" />
						</a4j:outputPanel>
					</div>
					<div class="w3-half">
                        <a4j:outputPanel id="dictationHistoryInput">
                            <h:messages tooltip="true" errorClass="w3-text-red" globalOnly="false" />
                            <h:panelGroup rendered="#{dictationPracticeController.showHistoryInputForm}">
                                <div class="w3-panel">
                                    <a onclick="addOrRemoveW3Show('description')" class="w3-btn-block w3-padding w3-left-align w3-light-grey w3-medium w3-leftbar">
                                        <i class="fa fa-chevron-down" aria-hidden="true"></i> #{dictationMsg.submitYourInfo}
                                    </a>
                                    <div id="description" class="w3-accordion-content w3-container w3-medium w3-leftbar">
                                        <a4j:region>

                                                <table>
                                                    <tr>
                                                        <td>#{dictationMsg.name}</td>
                                                        <td>:</td>
                                                        <td>
                                                            <h:inputText id="name" value="#{dictationPracticeController.dictationHistory.practicerName}"
                                                                         maxlength="50" styleClass="w3-input"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>#{dictationMsg.school}</td>
                                                        <td>:</td>
                                                        <td><h:inputText id="school" value="#{dictationPracticeController.dictationHistory.practicerSchool}"
                                                                         maxlength="255" styleClass="w3-input" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td>#{dictationMsg.age}</td>
                                                        <td>:</td>
                                                        <td>
                                                            <h:selectOneRadio id="ageGroup" value="#{dictationPracticeController.dictationHistory.ageGroupValue}"
                                                                              layout="pageDirection" layoutWidth="4">
                                                                <f:selectItems value="#{dictationEditController.availableAgeGroups}" />
                                                            </h:selectOneRadio>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <a4j:commandButton render="dictationHistoryInput" styleClass="w3-btn w3-light-grey"
                                                                   action="#{dictationPracticeController.submitDictationHistory}"
                                                                   value="#{dictationMsg.submit}" />

                                        </a4j:region>
                                    </div>
                                </div>
                            </h:panelGroup>
                            <c:if test="#{not empty dictationPracticeController.memberDictationHistory}">
                                <esl:memberDictationHistory2 history="#{dictationPracticeController.memberDictationHistory}" />
                            </c:if>
                        </a4j:outputPanel>
					</div>
				</div>

                <esl:scoreBar2 startMark="#{dictationPracticeController.practice.mark}" maxMark="#{dictationPracticeController.practice.totalQuestions}" />
                <div class="w3-responsive">
                    <table class="w3-table-all w3-medium w3-margin-top">
                        <thead>
                        <tr class="w3-theme">
                            <td></td>
                            <td><h:outputText value="#{selfDictationMsg.practicePhonetic}" /></td>
                            <td><h:outputText value="#{selfDictationMsg.practiceWord}" /></td>
                            <td><h:outputText value="#{selfDictationMsg.practiceAnswer}" /></td>
                            <td></td>
                        </tr>
                        </thead>
                        <tfoot>
                        <tr>
                            <td colspan="5">
                                <h:outputText value="#{selfDictationMsg.practiceMark}" />: #{dictationPracticeController.practice.mark} / #{dictationPracticeController.practice.totalQuestions}
                            </td>
                        </tr>
                        </tfoot>
                        <t:dataList var="i" rowIndexVar="index" value="#{dictationPracticeController.practice.answers}" >
                            <tr>
                                <td>Q<h:outputText value="#{dictationPracticeController.practice.currentQuestion-index}" /></td>
                                <td>[<h:outputText escape="false" value="#{dictationPracticeController.practice.questions[dictationPracticeController.practice.currentQuestion-1-index].IPA}" />]</td>
                                <td><a href="#{phonPracticeMsg.practiceDictionaryLink}#{dictationPracticeController.practice.questions[dictationPracticeController.practice.currentQuestion-1-index].word}" target="_blank"><u><h:outputText
                                        value="#{dictationPracticeController.practice.questions[dictationPracticeController.practice.currentQuestion-1-index].word}" /></u></a></td>
                                <td><h:outputText value="#{dictationPracticeController.practice.answers[dictationPracticeController.practice.currentQuestion-1-index]}" /></td>
                                <td>
                                    <a4j:outputPanel rendered="#{dictationPracticeController.practice.corrects[dictationPracticeController.practice.currentQuestion-1-index]}"><i class="fa fa-check w3-text-light-green" aria-hidden="true"></i></a4j:outputPanel>
                                    <a4j:outputPanel rendered="#{!dictationPracticeController.practice.corrects[dictationPracticeController.practice.currentQuestion-1-index]}"><i class="fa fa-times w3-text-red" aria-hidden="true"></i></a4j:outputPanel>
                                </td>
                            </tr>
                        </t:dataList>
                    </table>
                </div>
                <div class="w3-container w3-light-grey w3-border w3-small">
                    <p>* #{selfDictationMsg.practiceWordExplanation}</p>
                </div>



			</div>
		</h:form>
	</ui:define>

</ui:composition>